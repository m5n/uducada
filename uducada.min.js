/* uducada v0.1 - https://github.com/m5n/uducada */
var uducada=uducada||{};uducada.jsfwk=(function(e){function b(n,p,o){n.parent().find(p).addClass(o)}function c(n,p,o){n.parent().find(p).removeClass(o)}function g(n,o){n.parent().addClass(o)}function h(n,p,o){n.find(p).each(function(){o(e(this))})}function f(p,n,q,o){e(p).each(function(){var r=e(this);if(r.data(n)!==q){o(r)}})}function k(n,o){return n.parent().find(o)}function d(o,n){if(typeof o==="string"){o=e(o)}return o.data(n)}function m(o,p){var n={};if(typeof o==="string"){o=e(o)}e.each(p,function(q,r){n[r]=o.data(r)});return n}function l(n){n.stopImmediatePropagation()}function i(o,n,p){o.bind(n,p)}function j(n,p,o){n.find(p).removeClass(o)}function a(p,o,n){e(p).trigger(o,n)}return{addClassToElementInParent:b,addClassToParent:g,callFunctionForNestedElements:h,callFunctionForElementsIfDataValueIsNot:f,findInParent:k,getInterpretedDataValue:d,getInterpretedDataValues:m,haltEventPropagation:l,handle:i,removeClassFromElementInParent:c,removeClassFromNestedElements:j,trigger:a}}(jQuery));var uducada=uducada||{};uducada.uifwk=(function(e){function f(h){return h.val()}function d(j,k,i,h){if(e(k.srcElement).hasClass("ui-icon-closethick")||k.keyCode===e.ui.keyCode.ESCAPE){i(j,h)}}function b(k,j){var i=[],h;e.each(j.buttons,function(l,m){i.push({text:m.text,click:function(){j.onClick(k,m.type)}})});h=function(l){d(k,l,j.onClick,j.cancelButtonEventType)};k.dialog({autoOpen:j.autoOpen,buttons:i,close:h,closeOnEscape:j.closeOnEscape,dialogClass:j.showCloseIcon?undefined:j.hideCloseIconCssClass,draggable:j.draggable,modal:j.modal,resizable:j.resizable,title:j.title,width:j.width})}function g(i,h){i.find('input[type="text"]').bind("keypress",function(j){if(j.keyCode===e.ui.keyCode.ENTER){if(h.submitOnEnter){i.submit()}j.preventDefault();return false}});i.find(h.characterCountFieldCssSelector).each(function(){var l=e(this),k=h.getCharacterCountDisplayElementFunction(l),j=h.getFormatRegExFunction(l.data(h.formatDataOption));k.text(l.val().length);l.bind("change keydown keyup",function(){k.text(l.val().length);if(j){h.handleInputValidationFunction(l,l.val(),j)}})})}function a(i,h){if(typeof i==="string"){i=e(i,h)}i.show()}function c(i,h){if(typeof i==="string"){i=e(i,h)}i.hide()}return{getInput:f,hide:c,initDialog:b,initForm:g,show:a}}(jQuery));var uducada=uducada||{};uducada.dialog=(function(){var h,i,c,e,b;function g(k,j){uducada.jsfwk.trigger(k,"button:"+j,[j])}function a(o,n){var k,m,l,j=[];k=(o&&o.length>0)?o.split(","):[];for(l=0;l<k.length;l+=1){m=k[l].split(":");if(n&&m.length<2){throw new Error('Text missing for button event type "'+m[0]+'"')}j.push({type:m[0],text:m.length>1?m[1]:undefined})}return j}function f(){var l,j,k;l=uducada.jsfwk.getInterpretedDataValue("body","dialog-defaults")||{};h={};j=a(l.buttonText||"",true);for(k=0;k<j.length;k+=1){h[j[k].type]=j[k].text}i=undefined===l.closeOnEscape?true:l.closeOnEscape;c=undefined===l.draggable?true:l.draggable;e=undefined===l.resizable?true:l.resizable;b=l.showCloseIcon||false}function d(k){var j,l;j=uducada.jsfwk.getInterpretedDataValues(k,["buttons","close-on-escape","draggable","modal","resizable","show-close-icon","title","width"]);j.autoOpen=false;j.buttons=a(j.buttons,false);for(l=0;l<j.buttons.length;l+=1){if(!j.buttons[l].text){j.buttons[l].text=h[j.buttons[l].type];if(!j.buttons[l].text){throw new Error('Missing or no default text for button event type "'+j.buttons[l].type+'"')}}}j.cancelButtonEventType="cancel";j.closeOnEscape=undefined===j["close-on-escape"]?i:j["close-on-escape"];delete j["close-on-escape"];j.draggable=undefined===j.draggable?c:j.draggable;j.onClick=g;j.resizable=undefined===j.resizable?e:j.resizable;j.showCloseIcon=undefined===j["show-close-icon"]?b:j["show-close-icon"];delete j["show-close-icon"];j.hideCloseIconCssClass="uducada-hide-close-icon";uducada.uifwk.initDialog(k,j)}f();uducada.jsfwk.callFunctionForElementsIfDataValueIsNot(".dialog","skip-init",true,d);return{init:d}}());var uducada=uducada||{};uducada.form=(function(){var c;function e(){var f;f=uducada.jsfwk.getInterpretedDataValue("body","form-defaults")||{};c=undefined===f.submitOnEnter?false:f.submitOnEnter}function a(g){var f;if(g!==undefined){g=g.replace(/\{,/g,"{0,");g=g.split("/");f=new RegExp(g[1],g[2])}return f}function b(f,g){f=f.replace(/[\n\r]/g," ");return g.test(f)}function d(g){var f;f=uducada.jsfwk.getInterpretedDataValues(g,["submit-on-enter"]);f.characterCountFieldCssSelector='[data-show-character-count="true"]';f.getCharacterCountDisplayElementFunction=function(h){return uducada.jsfwk.findInParent(h,".count-text .count")};f.formatDataOption="format";f.getFormatRegExFunction=a;f.handleInputValidationFunction=function(j,h,i){if(b(h,i)){uducada.jsfwk.removeClassFromElementInParent(j,".count-text","uducada-validation-failed")}else{uducada.jsfwk.addClassToElementInParent(j,".count-text","uducada-validation-failed")}};f.submitOnEnter=undefined===f["submit-on-enter"]?c:f["submit-on-enter"];delete f["submit-on-enter"];uducada.uifwk.initForm(g,f);uducada.jsfwk.handle(g,"submit",function(h){var i=true;uducada.uifwk.hide(".required-text, .validation-text",g);uducada.jsfwk.removeClassFromNestedElements(g,"label","uducada-validation-failed");uducada.jsfwk.callFunctionForNestedElements(g,'[data-required="true"], [data-format]',function(n){var j,l,m,k=true;if(uducada.jsfwk.getInterpretedDataValue(n,"required")&&!uducada.uifwk.getInput(n)){k=false;j=uducada.jsfwk.findInParent(n,".required-text")}else{m=uducada.jsfwk.getInterpretedDataValue(n,"format");l=a(m);if(m!==undefined){if(!b(uducada.uifwk.getInput(n),l)){k=false;j=uducada.jsfwk.findInParent(n,".validation-text")}}}if(!k){uducada.jsfwk.addClassToParent(n,"uducada-validation-failed");uducada.uifwk.show(j);i=false}});if(!i){uducada.jsfwk.haltEventPropagation(h)}return i})}e();uducada.jsfwk.callFunctionForElementsIfDataValueIsNot("form","skip-init",true,d);return{init:d}}());
/* uducada v0.1 - https://github.com/m5n/uducada */

var uducada=uducada||{};uducada.jsfwk=(function(c){function e(l,m){l.parent().addClass(m)}function f(l,n,m){l.find(n).each(function(){m(c(this))})}function d(n,l,o,m){c(n).each(function(){var p=c(this);if(p.data(l)!==o){m(p)}})}function i(l,m){return l.parent().find(m)}function b(m,l){if(typeof m==="string"){m=c(m)}return m.data(l)}function k(m,n){var l={};if(typeof m==="string"){m=c(m)}c.each(n,function(o,p){l[p]=m.data(p)});return l}function j(l){l.stopImmediatePropagation()}function g(m,l,n){m.bind(l,n)}function h(l,n,m){l.find(n).removeClass(m)}function a(n,m,l){c(n).trigger(m,l)}return{addClassToParent:e,callFunctionForNestedElements:f,callFunctionForElementsIfDataValueIsNot:d,findInParent:i,getInterpretedDataValue:b,getInterpretedDataValues:k,haltEventPropagation:j,handle:g,removeClassFromNestedElements:h,trigger:a}}(jQuery));var uducada=uducada||{};uducada.uifwk=(function(e){function f(h){return h.val()}function d(j,k,i,h){if(e(k.srcElement).hasClass("ui-icon-closethick")||k.keyCode===e.ui.keyCode.ESCAPE){i(j,h)}}function b(k,j){var i=[],h;e.each(j.buttons,function(l,m){i.push({text:m.text,click:function(){j.onClick(k,m.type)}})});h=function(l){d(k,l,j.onClick,j.cancelButtonEventType)};k.dialog({autoOpen:j.autoOpen,buttons:i,close:h,closeOnEscape:j.closeOnEscape,dialogClass:j.showCloseIcon?undefined:j.hideCloseIconCssClass,draggable:j.draggable,modal:j.modal,resizable:j.resizable,title:j.title,width:j.width})}function g(i,h){i.find('input[type="text"]').bind("keypress",function(j){if(j.keyCode===e.ui.keyCode.ENTER){if(h.submitOnEnter){i.submit()}j.preventDefault();return false}})}function a(i,h){if(typeof i==="string"){i=e(i,h)}i.show()}function c(i,h){if(typeof i==="string"){i=e(i,h)}i.hide()}return{getInput:f,hide:c,initDialog:b,initForm:g,show:a}}(jQuery));var uducada=uducada||{};uducada.dialog=(function(){var h,i,c,e,b;function g(k,j){uducada.jsfwk.trigger(k,"button:"+j,[j])}function a(o,n){var k,m,l,j=[];k=(o&&o.length>0)?o.split(","):[];for(l=0;l<k.length;l+=1){m=k[l].split(":");if(n&&m.length<2){throw new Error('Text missing for button event type "'+m[0]+'"')}j.push({type:m[0],text:m.length>1?m[1]:undefined})}return j}function f(){var l,j,k;l=uducada.jsfwk.getInterpretedDataValue("body","dialog-defaults")||{};h={};j=a(l.buttonText||"",true);for(k=0;k<j.length;k+=1){h[j[k].type]=j[k].text}i=undefined===l.closeOnEscape?true:l.closeOnEscape;c=undefined===l.draggable?true:l.draggable;e=undefined===l.resizable?true:l.resizable;b=l.showCloseIcon||false}function d(k){var j,l;j=uducada.jsfwk.getInterpretedDataValues(k,["buttons","close-on-escape","draggable","modal","resizable","show-close-icon","title","width"]);j.autoOpen=false;j.buttons=a(j.buttons,false);for(l=0;l<j.buttons.length;l+=1){if(!j.buttons[l].text){j.buttons[l].text=h[j.buttons[l].type];if(!j.buttons[l].text){throw new Error('Missing or no default text for button event type "'+j.buttons[l].type+'"')}}}j.cancelButtonEventType="cancel";j.closeOnEscape=undefined===j["close-on-escape"]?i:j["close-on-escape"];delete j["close-on-escape"];j.draggable=undefined===j.draggable?c:j.draggable;j.onClick=g;j.resizable=undefined===j.resizable?e:j.resizable;j.showCloseIcon=undefined===j["show-close-icon"]?b:j["show-close-icon"];delete j["show-close-icon"];j.hideCloseIconCssClass="uducada-hide-close-icon";uducada.uifwk.initDialog(k,j)}f();uducada.jsfwk.callFunctionForElementsIfDataValueIsNot(".dialog","skip-init",true,d);return{init:d}}());var uducada=uducada||{};uducada.form=(function(){var a;function c(){var d;d=uducada.jsfwk.getInterpretedDataValue("body","form-defaults")||{};a=undefined===d.submitOnEnter?false:d.submitOnEnter}function b(e){var d;d=uducada.jsfwk.getInterpretedDataValues(e,["submit-on-enter"]);d.submitOnEnter=undefined===d["submit-on-enter"]?a:d["submit-on-enter"];delete d["submit-on-enter"];uducada.uifwk.initForm(e,d);uducada.jsfwk.handle(e,"submit",function(f){var g=true;uducada.uifwk.hide(".required-text, .validation-text",e);uducada.jsfwk.removeClassFromNestedElements(e,"label","uducada-validation-failed");uducada.jsfwk.callFunctionForNestedElements(e,'[data-required="true"], [data-format]',function(l){var h,j,k,i=true;if(uducada.jsfwk.getInterpretedDataValue(l,"required")&&!uducada.uifwk.getInput(l)){i=false;h=uducada.jsfwk.findInParent(l,".required-text")}else{k=uducada.jsfwk.getInterpretedDataValue(l,"format");if(k!==undefined){k=k.replace(/\{,/g,"{0,");k=k.split("/");j=new RegExp(k[1],k[2]);if(!j.test(uducada.uifwk.getInput(l))){i=false;h=uducada.jsfwk.findInParent(l,".validation-text")}}}if(!i){uducada.jsfwk.addClassToParent(l,"uducada-validation-failed");uducada.uifwk.show(h);g=false}});if(!g){uducada.jsfwk.haltEventPropagation(f)}return g})}c();uducada.jsfwk.callFunctionForElementsIfDataValueIsNot("form","skip-init",true,b);return{init:b}}());